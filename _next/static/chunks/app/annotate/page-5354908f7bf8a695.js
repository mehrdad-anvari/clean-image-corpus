(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[407],{1006:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>l,Q6:()=>s,QH:()=>o,oc:()=>i});let a=(0,n(1990).Z0)({name:"annotationSettings",initialState:{rectClasses:{0:{name:"default",color:[255,255,255]}},rectMinEdgeSize:.02},reducers:{addRectClass:(e,t)=>{e.rectClasses[t.payload.id]=t.payload.attrs},deleteRectClass:(e,t)=>{delete e.rectClasses[t.payload]},setSettings:(e,t)=>({...e,...t.payload})}}),{addRectClass:s,deleteRectClass:o,setSettings:i}=a.actions,l=a.reducer},1783:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>S,Bb:()=>p,C5:()=>w,HD:()=>z,I_:()=>I,Kg:()=>x,M:()=>h,Mu:()=>v,O8:()=>A,OE:()=>r,U_:()=>u,_y:()=>b,aA:()=>f,cE:()=>y,cr:()=>d,eU:()=>N,fw:()=>m,nj:()=>g,rY:()=>l,v0:()=>j,xJ:()=>c,xh:()=>C});var a=n(1990),s=n(7355);let o={selectedAnnotation:-1,selectedVertex:-1,hoveringAnnotation:-1,hoveringVertex:-1,annotations:{},annotationsHistory:{0:{annotations:{},length:0}},historyIndex:0,selectedTool:"SELECT",width:640,height:640,selectedClassID:0,lastIndex:0,historyLastIndex:0,zoom:800},i=(0,a.Z0)({name:"canvas",initialState:o,reducers:{loadAnnotations:(e,t)=>{e.lastIndex=t.payload.length;let n={};t.payload.forEach((e,t)=>{n[t]={object:e}}),e.annotations=n,e.annotationsHistory={0:{annotations:n,length:t.payload.length}}},startDrawRect:(e,t)=>{let n=t.payload.classID,a=t.payload.mousePosition,s={class_id:n,x1:a.x,y1:a.y,x2:a.x,y2:a.y};e.annotations[e.lastIndex]={object:s},e.lastIndex+=1},resetHistory:e=>{e.annotationsHistory={0:{annotations:{},length:0}},e.historyIndex=0},saveAnnotationsHistory:e=>{e.annotationsHistory[e.historyIndex+1]={annotations:e.annotations,length:e.lastIndex},e.historyLastIndex=e.historyIndex+1,e.historyIndex+=1,console.log("saving state")},goForwardHistory:e=>{e.historyIndex<e.historyLastIndex&&(e.historyIndex+=1,e.annotations=e.annotationsHistory[e.historyIndex].annotations,e.lastIndex=e.annotationsHistory[e.historyIndex].length)},goBackwardHistory:e=>{e.historyIndex>0&&(e.historyIndex-=1,e.annotations=e.annotationsHistory[e.historyIndex].annotations,e.lastIndex=e.annotationsHistory[e.historyIndex].length)},updateDrawRect:(e,t)=>{let n=e.annotations[e.lastIndex-1].object,a=t.payload;e.annotations[e.lastIndex-1].object={class_id:n.class_id,x1:n.x1,y1:n.y1,x2:a.x,y2:a.y}},updateRect:(e,t)=>{e.annotations[t.payload.Index].object=t.payload.updatedRect},updateHoveringAnnotation:(e,t)=>{e.hoveringAnnotation=-1;let n=t.payload;for(let[t,a]of Object.entries(e.annotations))if(s.A.containPoint(a.object,n.x,n.y)){e.hoveringAnnotation=Number(t);break}},updateHoveringVertex:(e,t)=>{let n=t.payload;if(e.selectedAnnotation>-1){let t=s.A.findNearestVertex(e.annotations[e.selectedAnnotation].object,n.x,n.y);null!=t&&(e.hoveringVertex=t)}},selectAnnotationFromHover:e=>{e.selectedAnnotation=e.hoveringAnnotation},selectVertexFromHover:e=>{e.selectedVertex=e.hoveringVertex},resetSelectedAnnotation:e=>{e.selectedAnnotation=-1},setSelectedAnnotation:(e,t)=>{e.selectedAnnotation=t.payload},resetSelectedVertex:e=>{e.selectedVertex=-1},moveVertex:(e,t)=>{let n=t.payload;if(e.selectedAnnotation>-1&&e.selectedVertex>-1){let t=s.A.moveVertex(e.annotations[e.selectedAnnotation].object,n.x,n.y,e.selectedVertex);void 0!=t&&(e.annotations[e.selectedAnnotation].object=t)}},setSelectedTool:(e,t)=>{e.selectedTool=t.payload},setCanvasSize:(e,t)=>{e.width=t.payload.width,e.height=t.payload.height},setSelectedClassID:(e,t)=>{e.selectedClassID=t.payload},removeAnnotation:(e,t)=>{delete e.annotations[t.payload]},resetCanvasState:()=>o}}),{startDrawRect:l,updateDrawRect:r,updateHoveringAnnotation:c,updateHoveringVertex:d,goBackwardHistory:u,goForwardHistory:x,selectAnnotationFromHover:h,selectVertexFromHover:m,setSelectedTool:b,moveVertex:y,resetCanvasState:g,resetSelectedAnnotation:f,resetSelectedVertex:p,saveAnnotationsHistory:v,setCanvasSize:w,setSelectedClassID:j,loadAnnotations:z,resetHistory:N,setSelectedAnnotation:C,removeAnnotation:A,updateRect:I}=i.actions,S=i.reducer},4065:(e,t,n)=>{"use strict";async function a(e,t){let n=await e.getFileHandle("settings.json",{create:!0}),a=await n.createWritable();await a.write(JSON.stringify(t,null,2)),await a.close(),console.log("Saved ".concat(t," to settings.json file."))}async function s(e){try{let t=await e.getFileHandle("settings.json",{create:!1}),n=await t.getFile(),a=await n.text();return JSON.parse(a)}catch(e){return console.log("Error in loading the settings.json",e),null}}n.d(t,{D:()=>a,M:()=>s})},5215:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>j});var a=n(5155),s=n(2115);function o(e){var t,n;let{cards:s,onSelect:o,handlePrevious:i,handleNext:l,imagesLen:r}=e,c=null!==(n=null===(t=s[2])||void 0===t?void 0:t[0])&&void 0!==n?n:0;return(0,a.jsxs)("aside",{className:"w-full md:w-64 p-4 bg-zinc-900 border-r border-zinc-700 overflow-y-auto h-[90vh] max-h-screen shadow-inner flex flex-col gap-4 text-zinc-100",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("button",{onClick:i,disabled:0===c,className:"px-3 py-1 text-sm font-medium rounded border transition duration-150 ".concat(0===c?"bg-zinc-700 text-zinc-500 border-zinc-600 cursor-not-allowed":"bg-zinc-800 hover:bg-zinc-700 text-blue-400 border-blue-500"),children:"← Previous"}),(0,a.jsx)("button",{onClick:l,disabled:c===r-1,className:"px-3 py-1 text-sm font-medium rounded border transition duration-150 ".concat(c===r-1?"bg-zinc-700 text-zinc-500 border-zinc-600 cursor-not-allowed":"bg-zinc-800 hover:bg-zinc-700 text-blue-400 border-blue-500"),children:"Next →"})]}),(0,a.jsxs)("div",{className:"text-center text-xs text-zinc-400",children:["Image ",(0,a.jsx)("span",{className:"font-semibold text-zinc-100",children:c+1})," of"," ",(0,a.jsx)("span",{className:"font-semibold text-zinc-100",children:r})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-3 justify-items-center",children:s.map((e,t)=>{let[n,s]=e;return s?(0,a.jsx)("img",{src:s,alt:"Image ".concat(n),onClick:()=>o(t),className:"object-cover cursor-pointer rounded-md border transition-all duration-200 ".concat(2===t?"w-48 h-32 border-blue-500 shadow-lg opacity-100":"w-40 h-28 border-zinc-600 opacity-60 hover:opacity-90 hover:border-blue-400")},t):(0,a.jsx)("div",{className:"w-40 h-28 bg-zinc-700 text-zinc-400 flex items-center justify-center rounded-md",children:"Empty"},t)})})]})}function i(e){let t=e.currentTarget.getBoundingClientRect(),n=e.currentTarget.width,a=e.currentTarget.height;return{x:(e.clientX-t.left)/n,y:(e.clientY-t.top)/a}}var l=n(1783);function r(e,t,n){if("keydown"===e.type||"keyup"===e.type){var a,s,o;a=e,s=0,o=n,"keydown"===a.type&&(a.ctrlKey&&"key"in a&&"z"===a.key&&o((0,l.U_)()),a.ctrlKey&&"key"in a&&"y"===a.key&&o((0,l.Kg)()));return}if("mousemove"===e.type||"mousedown"===e.type||"mouseup"===e.type)switch(t.selectedTool){case"SELECT":!function(e,t,n){switch(e.type){case"mousedown":if(-1!=t.hoveringAnnotation)n((0,l._y)("EDIT_RECT")),n((0,l.M)());else{let a=i(e);n((0,l._y)("DRAW_RECT")),n((0,l.rY)({classID:t.selectedClassID,mousePosition:a}))}break;case"mouseup":break;case"mousemove":let a=i(e);n((0,l.xJ)(a)),n((0,l.cr)(a))}}(e,t,n);break;case"EDIT_RECT":!function(e,t,n){switch(e.type){case"mousedown":-1!=t.hoveringVertex?n((0,l.fw)()):(n((0,l.Bb)()),-1!=t.hoveringAnnotation?n((0,l.M)()):(n((0,l._y)("SELECT")),n((0,l.aA)())));break;case"mouseup":-1!=t.selectedVertex&&(n((0,l.Mu)()),n((0,l.Bb)()),n((0,l._y)("SELECT")));break;case"mousemove":let a=i(e);n((0,l.xJ)(a)),n((0,l.cr)(a)),-1!=t.selectedVertex&&n((0,l.cE)(a))}}(e,t,n);break;case"DRAW_RECT":!function(e,t,n){switch(e.type){case"mousedown":let a=i(e);n((0,l.rY)({classID:t.selectedClassID,mousePosition:a}));break;case"mouseup":n((0,l.Mu)()),n((0,l._y)("SELECT"));break;case"mousemove":let s=i(e);n((0,l.OE)(s))}}(e,t,n)}}var c=n(7355),d=n(9007),u=n(4540);function x(e){let{imageSrc:t}=e,n=(0,s.useRef)(null),o=(0,d.j)(),i=(0,u.d4)(e=>e.canvas),x=(0,u.d4)(e=>e.settings);return(0,s.useEffect)(()=>{if(!t||!n.current)return;let e=new Image;e.src=t;let a=()=>{let t=Math.max(e.width,e.height)/i.zoom,n=e.width/t,a=e.height/t;o((0,l.C5)({width:n,height:a}))};return e.addEventListener("load",a),()=>{e.removeEventListener("load",a)}},[i,t]),(0,s.useEffect)(()=>{t&&n.current&&!function(e,t,n,a){let s=new Image;s.src=t,e.width=n.width,e.height=n.height;let o=e.getContext("2d");o.clearRect(0,0,e.width,e.height),o.drawImage(s,0,0,e.width,e.height);let i=null;for(let[t,s]of Object.entries(n.annotations)){let o=Number(t),l=s.object,r=a.rectClasses[s.object.class_id].color;l&&(i=o===n.selectedAnnotation?n.hoveringVertex:null,"DRAW_RECT"==n.selectedTool?c.A.draw(l,e,o===n.selectedAnnotation,null,r):"SELECT"==n.selectedTool?c.A.draw(l,e,o===n.hoveringAnnotation||o===n.selectedAnnotation,null,r):c.A.draw(l,e,o===n.hoveringAnnotation||o===n.selectedAnnotation,i,r))}}(n.current,t,i,x)},[t,i]),(0,a.jsx)("div",{className:"relative w-full h-full flex items-center justify-center bg-zinc-950",children:(0,a.jsx)("canvas",{ref:n,onMouseDown:e=>{r(e,i,o)},onMouseMove:e=>{r(e,i,o)},onMouseUp:e=>{r(e,i,o)},onKeyDown:e=>{r(e,i,o)},tabIndex:0,className:"outline-none border border-zinc-700  shadow-md bg-zinc-900 focus:ring-1 focus:ring-blue-500 transition duration-150"})})}function h(){var e;let t=(0,d.j)(),n=(0,u.d4)(e=>e.canvas.selectedAnnotation),o=(0,u.d4)(e=>e.canvas.annotations),i=(0,u.d4)(e=>e.settings),r=Object.entries(o),c=-1!==n?null===(e=o[n])||void 0===e?void 0:e.object:null,[x,h]=(0,s.useState)(c?{...c}:null);(0,s.useEffect)(()=>{var e;h(c=-1!==n?null===(e=o[n])||void 0===e?void 0:e.object:null)},[n,o]);let m=e=>{t((0,l.xh)(e)),h({...o[e].object})},b=(e,t)=>{x&&h({...x,[e]:t})};return(0,a.jsxs)("div",{className:"w-full h-full bg-zinc-900 border-l border-zinc-700 text-zinc-100 flex flex-col",children:[(0,a.jsxs)("div",{className:"flex flex-col border-b border-zinc-700 flex-grow min-h-0",children:[(0,a.jsxs)("div",{className:"bg-zinc-800 px-4 py-2 text-sm font-medium text-zinc-200",children:["Annotations (",r.length,")"]}),(0,a.jsx)("div",{className:"overflow-y-auto flex-grow divide-y divide-zinc-700",children:0===r.length?(0,a.jsx)("p",{className:"p-3 text-sm text-zinc-500",children:"No annotations yet."}):r.map(e=>{let[s]=e,o=Number(s),i=o===n;return(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 text-sm cursor-pointer ".concat(i?"bg-zinc-800 border-l-4 border-blue-500":"hover:bg-zinc-800"),onClick:()=>m(o),children:[(0,a.jsxs)("span",{className:"text-zinc-300 font-medium",children:["#",o]}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),t((0,l.O8)(o)),t((0,l.Mu)()),o===n&&(t((0,l.xh)(-1)),h(null))},className:"text-red-400 hover:underline text-xs",children:"Remove"})]},s)})})]}),(0,a.jsxs)("div",{className:"border-t border-zinc-700 ",children:[(0,a.jsx)("div",{className:"bg-zinc-800 px-4 py-2 text-sm font-medium text-zinc-200",children:c?"Selected Annotation #".concat(n):"No annotation selected"}),c&&x&&(0,a.jsxs)("div",{className:"p-4 flex flex-col gap-2 text-xs bg-zinc-900",children:[["class_id","x1","y1","x2","y2"].map(e=>(0,a.jsxs)("label",{className:"flex justify-between items-center gap-2",children:[(0,a.jsx)("span",{className:"text-zinc-400",children:e}),(0,a.jsx)("input",{type:"number",value:x[e],onChange:t=>b(e,parseFloat(t.target.value)),className:"bg-zinc-800 text-zinc-100 px-2 py-1 text-right w-24 border border-zinc-600 focus:outline-none focus:ring focus:ring-blue-500"})]},e)),(0,a.jsx)("button",{onClick:()=>{null!==n&&x&&i.rectClasses[x.class_id]&&(t((0,l.I_)({updatedRect:x,Index:n})),t((0,l.v0)(x.class_id)),t((0,l.Mu)()))},className:"mt-2 w-full py-1 bg-blue-600 text-white hover:bg-blue-700 transition",children:"Save Changes"})]})]})]})}function m(e){let{onLoadImages:t,onSync:n,onSettings:s}=e;return(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsx)("button",{onClick:s,className:"bg-zinc-800 text-zinc-100 px-4 py-2 rounded-md border border-zinc-600 hover:bg-zinc-700 hover:border-blue-500 transition",children:"⚙️ Settings"}),(0,a.jsx)("button",{onClick:t,className:"bg-zinc-800 text-zinc-100 px-4 py-2 rounded-md border border-zinc-600 hover:bg-zinc-700 hover:border-blue-500 transition",children:"\uD83D\uDCC1 Load Images"}),(0,a.jsx)("button",{onClick:n,className:"bg-zinc-800 text-zinc-100 px-4 py-2 rounded-md border border-zinc-600 hover:bg-zinc-700 hover:border-blue-500 transition",children:"\uD83D\uDD04 Sync Images"})]})}var b=n(4383),y=n(5373),g=n(1006),f=n(4065);let p=()=>[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())],v=e=>{let{color:t=[255,255,255]}=e;return(0,a.jsx)("div",{className:"w-5 h-5 rounded shadow-sm",style:{backgroundColor:"rgb(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")")}})},w=e=>{let{isOpen:t,onClose:n,settings:o}=e,i=(0,d.j)(),[l,r]=(0,s.useState)(""),[c,u]=(0,s.useState)(p()),[x,h]=(0,s.useState)(Object.keys(o.rectClasses).length),[m,b]=(0,s.useState)("");if(!t)return null;let y=e=>{i((0,g.QH)(e))};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex justify-center items-center z-50",children:(0,a.jsx)("div",{className:"bg-zinc-900 p-6 rounded-xl shadow-2xl w-full max-w-xl border border-zinc-700",children:(0,a.jsxs)("div",{className:"p-2 sm:p-4 text-zinc-100",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Rectangle Classes"}),m&&(0,a.jsx)("p",{className:"text-red-400 mb-2",children:m}),(0,a.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[(0,a.jsx)("input",{type:"text",value:l,onChange:e=>r(e.target.value),placeholder:"Class Name",className:"bg-zinc-800 text-white border border-zinc-600 p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("input",{type:"color",value:"#".concat(c.map(e=>e.toString(16).padStart(2,"0")).join("")),onChange:e=>{u(e.target.value.slice(1).match(/.{1,2}/g).map(e=>parseInt(e,16)))},onClick:()=>{u(p())},className:"cursor-pointer border border-zinc-600 rounded-md w-10 h-10"})]}),(0,a.jsx)("button",{onClick:()=>{if(""===l.trim()){b("Class name cannot be empty.");return}let e=Object.values(o.rectClasses).some(e=>e.name===l),t=Object.values(o.rectClasses).some(e=>e.color[0]===c[0]&&e.color[1]===c[1]&&e.color[2]===c[2]);if(e){b("Class name already exists.");return}if(t){b("Class color already exists.");return}i((0,g.Q6)({id:x,attrs:{name:l,color:c}})),r(""),u(p()),h(x+1),b("")},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition",children:"Add Class"})]}),(0,a.jsx)("div",{className:"overflow-y-auto max-h-72 border-t border-zinc-700 pt-4",children:(0,a.jsx)("ul",{className:"space-y-3",children:Object.entries(o.rectClasses).map(e=>{let[t,{name:n,color:s}]=e;return(0,a.jsxs)("li",{className:"flex items-center justify-between gap-3 text-sm bg-zinc-800 p-2 rounded-md shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(v,{color:s}),(0,a.jsxs)("span",{className:"text-zinc-400",children:["#",t]}),(0,a.jsx)("span",{className:"text-zinc-100",children:n})]}),(0,a.jsx)("button",{onClick:()=>y(Number(t)),className:"bg-red-600 hover:bg-red-700 text-white py-1 px-3 rounded-md transition",children:"Remove"})]},t)})})}),(0,a.jsx)("button",{className:"mt-6 w-full bg-zinc-700 hover:bg-zinc-600 text-white py-2 rounded-md transition",onClick:n,children:"Close"})]})})})};function j(){let e=(0,d.j)(),t=(0,u.d4)(e=>e.canvas),n=(0,u.d4)(e=>e.settings),{db:i,imagesDirHandle:r,rootDirHandle:c,annotationsDirHandle:g}=(0,y.B)(),p=[null,null,null],[v,j]=(0,s.useState)([p,p,p,p,p]),[z,N]=(0,s.useState)(0),[C,A]=(0,s.useState)(!1),[I,S]=(0,s.useState)(0),k=()=>{A(!C),c&&(0,f.D)(c,n)};function E(e){let t=e.lastIndexOf(".");return -1===t?"".concat(e,".json"):"".concat(e.substring(0,t),".json")}async function M(){if(!g||!v[2][1])return;let e=v[2][2];if(!e)return;let n=E(e.name),a=[];for(let e=0;e<t.lastIndex;e++){if(void 0==t.annotations[e])continue;let n=t.annotations[e].object;a.push(n)}try{let e=await g.getFileHandle(n,{create:!0}),t=await e.createWritable();await t.write(JSON.stringify({name:n,annotations:a,labels:[]},null,2)),await t.close()}catch(e){console.error("Error saving annotations:",e)}}async function D(t){let n=t[2];if(null==n||null==g)return;let a=E(n.name);try{let t=await g.getFileHandle(a),n=await t.getFile(),s=await n.text(),o=JSON.parse(s);e((0,l.HD)(o.annotations))}catch(t){console.warn('Annotation file "'.concat(a,'" could not load. error: "').concat(t,'"')),e((0,l.HD)([])),e((0,l.eU)())}}async function _(){if(!i)return;let e=await (0,b.AK)(i);N(e),await T(0,e,i,r,0)}async function H(){r&&c&&i&&(await (0,b.kP)(r,i),await (0,b.wZ)(i,c),N(await (0,b.AK)(i)))}async function T(t,n,a,s,o){if(!a||!s)return;let i=o+t;if(i<0||i>=n)return;let r=Math.floor(2.5),c=Math.max(0,i-r),d=Math.min(n,i+r+1)-c,u=Math.max(0,r-i),x=await (0,b.kg)(s,a,c,d);if(!x)return;let h=[...Array(u).fill(p),...x,...Array(5-d-u).fill(p)];j(h),e((0,l.nj)()),await D(h[2]),S(i)}async function V(){await M(),await T(-1,z,i,r,I)}async function R(){await M(),await T(1,z,i,r,I)}async function O(e){let t=Math.floor(2.5);await M(),await T(e-t,z,i,r,I)}return(0,a.jsxs)("div",{className:"flex flex-col h-screen bg-zinc-950 text-zinc-100 h-full",children:[(0,a.jsx)("header",{className:"bg-zinc-900 border-b border-zinc-700 px-4 py-3 shadow-md",children:(0,a.jsx)(m,{onLoadImages:_,onSync:H,onSettings:k})}),(0,a.jsxs)("div",{className:"flex flex-row flex-grow overflow-hidden h-full",children:[(0,a.jsx)("aside",{className:"bg-zinc-900 border-r border-zinc-700 w-full h-full md:w-64 overflow-y-auto",children:(0,a.jsx)(o,{cards:v,onSelect:O,handlePrevious:V,handleNext:R,imagesLen:z})}),(0,a.jsx)("main",{className:"flex-1 flex justify-center items-center h-full bg-zinc-950 p-4 overflow-hidden",children:(0,a.jsx)("div",{className:"max-w-full max-h-full",children:(0,a.jsx)(x,{imageSrc:v[2][1]})})}),(0,a.jsx)("aside",{className:"h-full w-full md:w-64 bg-zinc-900 border-l border-zinc-700",children:(0,a.jsx)(h,{})}),(0,a.jsx)(w,{isOpen:C,onClose:k,settings:n})]})]})}},6410:(e,t,n)=>{Promise.resolve().then(n.bind(n,5215))},7355:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});class a{static moveVertex(e,t,n,a){if(null==a)return;let s={...e};switch(a){case 1:s.x1=t,s.y1=n;break;case 2:s.x2=t,s.y1=n;break;case 3:s.x2=t,s.y2=n;break;case 4:s.x1=t,s.y2=n}return s}static findNearestVertex(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02,s=new Map([[1,{x:e.x1,y:e.y1}],[2,{x:e.x2,y:e.y1}],[3,{x:e.x2,y:e.y2}],[4,{x:e.x1,y:e.y2}]]),o=null,i=1/0;return s.forEach((e,s)=>{let l=Math.hypot(e.x-t,e.y-n);l<a&&l<i&&(i=l,o=s)}),o}static draw(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[255,0,0],o=t.width,i=t.height,l=t.getContext("2d");if(null==l)return;l.strokeStyle="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 1)");let r=e.x1*o,c=e.x2*o,d=e.y1*i,u=e.y2*i;if(l.beginPath(),l.lineWidth=1,l.fillStyle="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 0.9)"),l.rect(r-2,d-2,4,4),l.rect(r-2,u-2,4,4),l.rect(c-2,d-2,4,4),l.rect(c-2,u-2,4,4),a){let t=this.giveVertex(e,a);t&&l.rect(t.x*o-5,t.y*i-5,10,10)}l.fill(),l.rect(r,d,c-r,u-d),n?(l.fillStyle="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 0.2)"),l.fill()):l.stroke()}static containPoint(e,t,n){let a=Math.min(e.x1,e.x2),s=Math.max(e.x1,e.x2),o=Math.min(e.y1,e.y2),i=Math.max(e.y1,e.y2);return!!(a<t)&&!!(t<s)&&!!(o<n)&&!!(n<i)}static giveVertex(e,t){switch(t){case 1:return{x:e.x1,y:e.y1};case 2:return{x:e.x2,y:e.y1};case 3:return{x:e.x2,y:e.y2};case 4:return{x:e.x1,y:e.y2};default:return null}}static longestDimSize(e){return Math.max(Math.abs(e.y2-e.y1),Math.abs(e.x2-e.x1))}}let s=a},9007:(e,t,n)=>{"use strict";n.d(t,{j:()=>s});var a=n(4540);let s=a.wA.withTypes();a.d4.withTypes()}},e=>{var t=t=>e(e.s=t);e.O(0,[635,299,441,684,358],()=>t(6410)),_N_E=e.O()}]);