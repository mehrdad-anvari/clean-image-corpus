"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{1006:(t,e,a)=>{a.d(e,{$L:()=>u,Ay:()=>k,GI:()=>l,Ih:()=>c,K9:()=>y,LT:()=>g,Q6:()=>n,QH:()=>s,So:()=>b,To:()=>h,Wv:()=>f,Zv:()=>p,_h:()=>i,h$:()=>d,k5:()=>x,oc:()=>m,tk:()=>v,y5:()=>r});let o=(0,a(1990).Z0)({name:"annotationSettings",initialState:{pose:{0:{name:"default",color:[255,255,255],keypoints:{},skeleton:[]}},bbox:{0:{name:"default",color:[255,255,255]}},keypoint:{0:{name:"default",color:[255,255,255]}},polygon:{0:{name:"default",color:[255,255,255]}},line:{0:{name:"default",color:[255,255,255]}},obb:{0:{name:"default",color:[255,255,255]}},rectMinEdgeSize:.02},reducers:{addPoseClass:(t,e)=>{t.pose[e.payload.id]=e.payload.pose},addKeypointToPose:(t,e)=>{t.pose[e.payload.poseId].keypoints[e.payload.keypointId]=e.payload.keypoint},addEdgeToPose:(t,e)=>{t.pose[e.payload.poseId].skeleton.push([e.payload.from,e.payload.to])},addRectClass:(t,e)=>{t.bbox[e.payload.id]=e.payload.attrs},addPointClass:(t,e)=>{t.keypoint[e.payload.id]=e.payload.attrs},addPolygonClass:(t,e)=>{t.polygon[e.payload.id]=e.payload.attrs},addLineClass:(t,e)=>{t.line[e.payload.id]=e.payload.attrs},addObbClass:(t,e)=>{t.obb[e.payload.id]=e.payload.attrs},deletePoseClass:(t,e)=>{delete t.pose[e.payload]},deletePoseKeypointClass:(t,e)=>{delete t.pose[e.payload.poseId].keypoints[e.payload.keypointId]},deletePoseEdge:(t,e)=>{t.pose[e.payload.poseId].skeleton[e.payload.edgeIndex]&&t.pose[e.payload.poseId].skeleton.splice(e.payload.edgeIndex,1)},deleteRectClass:(t,e)=>{delete t.bbox[e.payload]},deletePointClass:(t,e)=>{delete t.keypoint[e.payload]},deletePolygonClass:(t,e)=>{delete t.polygon[e.payload]},deleteLineClass:(t,e)=>{delete t.line[e.payload]},deleteObbClass:(t,e)=>{delete t.obb[e.payload]},setSettings:(t,e)=>({...t,...e.payload})}}),{addRectClass:n,deleteRectClass:s,addPolygonClass:i,deletePolygonClass:l,addPointClass:r,deletePointClass:c,addLineClass:y,addKeypointToPose:d,addPoseClass:h,deleteLineClass:x,addObbClass:p,deleteObbClass:g,deletePoseClass:u,deletePoseKeypointClass:b,setSettings:m,addEdgeToPose:v,deletePoseEdge:f}=o.actions,k=o.reducer},1511:(t,e,a)=>{a.d(e,{A:()=>n});class o{static move(t,e,a){let o=this.getVertices(t),n=o.map(t=>-t.x),s=o.map(t=>1-t.x),i=o.map(t=>-t.y),l=o.map(t=>1-t.y);t.keypoints.forEach(t=>{n.push(-t.x),s.push(1-t.x),i.push(-t.y),l.push(1-t.y)});let r=n.length?Math.max(...n):-1/0,c=s.length?Math.min(...s):1/0,y=i.length?Math.max(...i):-1/0,d=l.length?Math.min(...l):1/0,h=(t,e,a)=>e>a?0:Math.min(a,Math.max(e,t)),x=h(e,r,c),p=h(a,y,d),g=t.keypoints.map(t=>({...t,x:t.x+x,y:t.y+p}));return{...t,x1:t.x1+x,x2:t.x2+x,y1:t.y1+p,y2:t.y2+p,keypoints:g}}static moveVertex(t,e,a,n){if(null==n)return t;let s=t=>Math.min(1,Math.max(0,t)),i=s(e),l=s(a),r={...t};switch(n){case 0:r.x1=i,r.y1=l;break;case 1:r.x2=i,r.y1=l;break;case 2:r.x2=i,r.y2=l;break;case 3:r.x1=i,r.y2=l}return o.getVertices(r).every(t=>t.x>=0&&t.x<=1&&t.y>=0&&t.y<=1)?r:t}static draw(t,e){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[255,0,0],l=e.width,r=e.height,c=e.getContext("2d");if(null==c)return;c.strokeStyle="rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 1)"),c.fillStyle="rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 1)"),c.lineWidth=1,c.beginPath();let y=this.getVertices(t).map(t=>({x:t.x*l,y:t.y*r}));y.forEach(t=>c.rect(t.x-2,t.y-2,4,4)),c.fill(),null!=o&&y[o]&&(c.rect(y[o].x-5,y[o].y-5,10,10),c.stroke()),c.closePath();let d=t.x1*l,h=t.x2*l,x=t.y1*r,p=t.y2*r;if(c.beginPath(),c.rect(d,x,h-d,p-x),a&&(c.fillStyle="rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 0.2)"),c.fill()),c.stroke(),c.closePath(),c.beginPath(),c.fillStyle="rgba(".concat(i[0],", ").concat(i[1],", ").concat(i[2],", 1.0)"),t.keypoints.forEach(t=>{let e=t.x*l,a=t.y*r;c.rect(e-2,a-2,4,4)}),c.stroke(),c.fill(),null!=n){let e=t.keypoints[n];e&&c.rect(e.x*l-5,e.y*r-5,10,10),c.stroke()}c.closePath(),s.forEach(e=>{if(t.keypoints[e[0]]&&t.keypoints[e[1]]){c.beginPath();let a=t.keypoints[e[0]].x*l,o=t.keypoints[e[0]].y*r,n=t.keypoints[e[1]].x*l,s=t.keypoints[e[1]].y*r;c.moveTo(a,o),c.lineTo(n,s),c.stroke(),c.closePath()}})}static getVertex(t,e){switch(e){case 0:return{x:t.x1,y:t.y1};case 1:return{x:t.x2,y:t.y1};case 2:return{x:t.x2,y:t.y2};case 3:return{x:t.x1,y:t.y2}}}static getVertices(t){return[0,1,2,3].map(e=>this.getVertex(t,e))}static addKeypoint(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=t.keypoints;return s.push({class_id:n,x:e,y:a,v:o}),{...t,keypoints:s}}static moveKeypoint(t,e,a,o){let n=t=>Math.min(1,Math.max(0,t)),s=n(e),i=n(a),l=[...t.keypoints];if(l[o]){let{class_id:e,v:a}=l[o];return l[o]={class_id:e,x:s,y:i,v:a},{...t,keypoints:l}}return t}static findNearestVertex(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02,n=null,s=1/0;return this.getVertices(t).forEach((t,i)=>{let l=Math.hypot(t.x-e,t.y-a);l<o&&l<s&&(s=l,n=i)}),n}static isNearVertex(t,e,a,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.02,s=this.getVertices(t);return!!s[o]&&Math.hypot(s[o].x-e,s[o].y-a)<n}static findNearestKeypoint(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02,n=null,s=1/0;return t.keypoints.forEach((t,i)=>{let l=Math.hypot(t.x-e,t.y-a);l<o&&l<s&&(s=l,n=i)}),n}static isNearKeypoint(t,e,a,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.02;return!!t.keypoints[o]&&Math.hypot(t.keypoints[o].x-e,t.keypoints[o].y-a)<n}static containPoint(t,e,a){let o=Math.min(t.x1,t.x2),n=Math.max(t.x1,t.x2),s=Math.min(t.y1,t.y2),i=Math.max(t.y1,t.y2);return!!(o<e)&&!!(e<n)&&!!(s<a)&&!!(a<i)}static longestDimSize(t){return Math.max(Math.abs(t.y2-t.y1),Math.abs(t.x2-t.x1))}}let n=o},1783:(t,e,a)=>{a.d(e,{A7:()=>tt,Ay:()=>tn,B:()=>T,Bb:()=>I,Bj:()=>E,C5:()=>V,CO:()=>F,Cr:()=>ta,DE:()=>N,G6:()=>Y,HD:()=>H,Hv:()=>J,Hw:()=>$,IR:()=>X,Kg:()=>b,M:()=>m,Mu:()=>A,Nz:()=>Q,O8:()=>D,OE:()=>x,QA:()=>_,Rx:()=>z,U_:()=>u,_:()=>G,_y:()=>f,aA:()=>P,cE:()=>k,cr:()=>g,eU:()=>j,fw:()=>v,gR:()=>te,ie:()=>to,ke:()=>L,kf:()=>U,mV:()=>q,nF:()=>W,nT:()=>O,nj:()=>M,pd:()=>R,rJ:()=>C,rY:()=>h,sY:()=>B,v0:()=>w,vJ:()=>K,xJ:()=>p,xh:()=>S,yx:()=>Z});var o=a(1990),n=a(7355),s=a(8108),i=a(2335),l=a(7132),r=a(1511);let c=t=>Math.min(1,Math.max(0,t)),y={selectedAnnotation:-1,selectedVertex:-1,selectedPoseKeypoint:-1,hoveringAnnotation:-1,hoveringVertex:-1,hoveringPoseKeypoint:-1,annotations:{},annotationsHistory:{0:{annotations:{},length:0}},historyIndex:0,selectedTool:"SELECT",width:640,height:640,selectedClassID:0,lastIndex:0,historyLastIndex:0,zoom:800,offsets:{x:0,y:0},isDrawing:!1,isEditing:!1,drawingPoseKeypointIndex:-1,isHandleSelected:!1,isHoveringHandle:!1,previousMousePosition:null},d=(0,o.Z0)({name:"canvas",initialState:y,reducers:{loadAnnotations:(t,e)=>{t.lastIndex=e.payload.length;let a={};e.payload.forEach((t,e)=>{a[e]={object:t}}),t.annotations=a,t.annotationsHistory={0:{annotations:a,length:e.payload.length}}},startDrawRect:(t,e)=>{let a=e.payload.classID,o=e.payload.mousePosition,n={type:"bbox",class_id:a,x1:o.x,y1:o.y,x2:o.x,y2:o.y};t.annotations[t.lastIndex]={object:n},t.lastIndex+=1},startDrawObb:(t,e)=>{let a=e.payload.classID,o=e.payload.mousePosition,n={type:"obb",class_id:a,xc:o.x,yc:o.y,w:0,h:0,alpha:0,imgW:t.width,imgH:t.height};t.annotations[t.lastIndex]={object:n},t.lastIndex+=1},startDrawPoly:(t,e)=>{let a=e.payload.classID,o=e.payload.mousePosition,n={type:"polygon",class_id:a,shell:[{x:o.x,y:o.y},{x:o.x,y:o.y}]};t.annotations[t.lastIndex]={object:n},t.selectedAnnotation=t.lastIndex,t.lastIndex+=1},drawPoint:(t,e)=>{let a=e.payload.classID,o=e.payload.mousePosition,n={type:"keypoint",class_id:a,x:Math.max(0,Math.min(o.x,1)),y:Math.max(0,Math.min(o.y,1))};t.annotations[t.lastIndex]={object:n},t.lastIndex+=1},startDrawPoseBbox:(t,e)=>{let a=e.payload.classID,o=e.payload.mousePosition,n={type:"pose",class_id:a,x1:c(o.x),y1:c(o.y),x2:c(o.x),y2:c(o.y),keypoints:[]};t.annotations[t.lastIndex]={object:n},t.selectedAnnotation=t.lastIndex,t.lastIndex+=1},startDrawPosePoint:(t,e)=>{let a=e.payload.id,o=e.payload.mousePosition,n=t.annotations[t.selectedAnnotation].object,s=n.keypoints;s.push({class_id:a,x:c(o.x),y:c(o.y),v:!0}),t.annotations[t.selectedAnnotation].object={...n,keypoints:s}},resetHistory:t=>{t.annotationsHistory={0:{annotations:{},length:0}},t.historyIndex=0},saveAnnotationsHistory:t=>{t.annotationsHistory[t.historyIndex+1]={annotations:t.annotations,length:t.lastIndex},t.historyLastIndex=t.historyIndex+1,t.historyIndex+=1,console.log("saving state")},goForwardHistory:t=>{t.historyIndex<t.historyLastIndex&&(t.historyIndex+=1,t.annotations=t.annotationsHistory[t.historyIndex].annotations,t.lastIndex=t.annotationsHistory[t.historyIndex].length)},goBackwardHistory:t=>{t.historyIndex>0&&(t.historyIndex-=1,t.annotations=t.annotationsHistory[t.historyIndex].annotations,t.lastIndex=t.annotationsHistory[t.historyIndex].length)},updateDrawRect:(t,e)=>{let a=t.annotations[t.lastIndex-1].object;if("bbox"!=a.type)return;let o=e.payload;t.annotations[t.lastIndex-1].object={type:"bbox",class_id:a.class_id,x1:a.x1,y1:a.y1,x2:o.x,y2:o.y}},updateDrawObb:(t,e)=>{let a=t.annotations[t.lastIndex-1].object;if("obb"!=a.type)return;let o=e.payload,n=o.x>a.xc?"right":"left",s=o.y>a.yc?"bottom":"top",l=0;switch(n+"-"+s){case"left-top":default:l=0;break;case"right-top":l=1;break;case"right-bottom":l=2;break;case"left-bottom":l=3}let r=i.A.moveVertex(a,o.x,o.y,l);t.annotations[t.lastIndex-1].object=r},updateDrawPoly:(t,e)=>{let a=t.annotations[t.lastIndex-1].object;if("polygon"!=a.type)return;let o=e.payload;t.annotations[t.lastIndex-1].object=l.A.addVertex(a,o.x,o.y)},updateDrawPolyVertex:(t,e)=>{let a=t.annotations[t.lastIndex-1].object;if("polygon"!=a.type)return;let o=e.payload;t.annotations[t.lastIndex-1].object=l.A.moveVertex(a,o.x,o.y)},updateDrawPoseBbox:(t,e)=>{let a=t.annotations[t.lastIndex-1].object;if("pose"!=a.type)return;let o=e.payload;t.annotations[t.lastIndex-1].object=r.A.moveVertex(a,o.x,o.y,2)},updateDrawPoseKeypoint:(t,e)=>{if("pose"!=t.annotations[t.lastIndex-1].object.type)return;let a=t.annotations[t.lastIndex-1].object;if(!a.keypoints[t.drawingPoseKeypointIndex])return;let o=e.payload,n=r.A.moveKeypoint(a,o.x,o.y,t.drawingPoseKeypointIndex);t.annotations[t.lastIndex-1].object=n},updateAnnotation:(t,e)=>{t.annotations[e.payload.Index].object=e.payload.updatedAnnotation},updateHoveringAnnotation:(t,e)=>{t.hoveringAnnotation=-1;let a=e.payload;for(let[e,o]of Object.entries(t.annotations)){switch(o.object.type){case"polygon":l.A.containPoint(o.object,a.x,a.y)&&(t.hoveringAnnotation=Number(e));break;case"pose":r.A.containPoint(o.object,a.x,a.y)&&(t.hoveringAnnotation=Number(e));break;case"obb":i.A.containPoint(o.object,a.x,a.y)&&(t.hoveringAnnotation=Number(e));break;case"bbox":n.A.containPoint(o.object,a.x,a.y)&&(t.hoveringAnnotation=Number(e));break;case"line":break;case"keypoint":s.A.isNear(o.object,a.x,a.y)&&(t.hoveringAnnotation=Number(e))}if(-1!=t.hoveringAnnotation)break}},updateHoveringVertex:(t,e)=>{let a=e.payload;if(t.selectedAnnotation>-1){let e=t.annotations[t.selectedAnnotation].object,o=null;switch(e.type){case"polygon":o=l.A.findNearestVertex(e,a.x,a.y);break;case"pose":o=r.A.findNearestVertex(e,a.x,a.y);break;case"obb":o=i.A.findNearestVertex(e,a.x,a.y,.02);break;case"bbox":o=n.A.findNearestVertex(e,a.x,a.y)}null!=o?t.hoveringVertex=o:t.hoveringVertex=-1}},updateHoveringPoseKeypoint:(t,e)=>{let a=e.payload;if(t.selectedAnnotation>-1){let e=t.annotations[t.selectedAnnotation].object;if("pose"==e.type){let o=r.A.findNearestKeypoint(e,a.x,a.y);null!=o?t.hoveringPoseKeypoint=o:t.hoveringPoseKeypoint=-1}}},updateHoveringHandle:(t,e)=>{let a=e.payload;if(t.selectedAnnotation>-1){let e=t.annotations[t.selectedAnnotation].object;switch(e.type){case"polygon":break;case"obb":t.isHoveringHandle=i.A.isHoveringHandle(e,a.x,a.y,.02,t.width,t.height)}}},setHandle:(t,e)=>{t.isHandleSelected=e.payload},selectAnnotationFromHover:t=>{t.selectedAnnotation=t.hoveringAnnotation},selectVertexFromHover:t=>{t.selectedVertex=t.hoveringVertex},selectKeypointFromHover:t=>{t.selectedPoseKeypoint=t.hoveringPoseKeypoint},resetSelectedAnnotation:t=>{t.selectedAnnotation=-1},setSelectedAnnotation:(t,e)=>{t.selectedAnnotation=e.payload},resetSelectedVertex:t=>{t.selectedVertex=-1},moveVertex:(t,e)=>{let a=e.payload;if(t.selectedAnnotation>-1&&t.selectedVertex>-1){let e=t.annotations[t.selectedAnnotation].object;switch(e.type){case"polygon":let o=l.A.moveVertex(e,a.x,a.y,t.selectedVertex);t.annotations[t.selectedAnnotation].object=o;break;case"obb":let s=i.A.moveVertex(e,a.x,a.y,t.selectedVertex);t.annotations[t.selectedAnnotation].object=s;break;case"bbox":let c=n.A.moveVertex(e,a.x,a.y,t.selectedVertex);void 0!=c&&(t.annotations[t.selectedAnnotation].object=c);break;case"pose":let y=r.A.moveVertex(e,a.x,a.y,t.selectedVertex);void 0!=y&&(t.annotations[t.selectedAnnotation].object=y)}}},moveSelectedPoint:(t,e)=>{let a=e.payload,o=t.annotations[t.selectedAnnotation].object;if("keypoint"==o.type){let e=s.A.move(o,a.x,a.y);t.annotations[t.selectedAnnotation].object=e}},setPreviousMousePosition:(t,e)=>{let a=e.payload;t.previousMousePosition={x:a.x,y:a.y}},resetPreviousMousePosition:t=>{t.previousMousePosition=null},setSelectedTool:(t,e)=>{t.selectedTool=e.payload},setCanvasSize:(t,e)=>{t.width=e.payload.width,t.height=e.payload.height},setSelectedClassID:(t,e)=>{t.selectedClassID=e.payload},setDrawingKeypointIndex:(t,e)=>{t.drawingPoseKeypointIndex=e.payload},removeAnnotation:(t,e)=>{delete t.annotations[e.payload]},setIsDrawing:(t,e)=>{t.isDrawing=e.payload},setIsEditing:(t,e)=>{t.isEditing=e.payload},zoomIn:t=>{t.zoom=t.zoom+50},zoomOut:t=>{t.zoom=Math.max(t.zoom-50,400)},setOffsets:(t,e)=>{t.offsets=e.payload},resetHoveringVertex:t=>{t.hoveringVertex=-1},resetSelectedKeypoint:t=>{t.selectedPoseKeypoint=-1},resetCanvasState:()=>y}}),{startDrawRect:h,updateDrawRect:x,updateHoveringAnnotation:p,updateHoveringVertex:g,goBackwardHistory:u,goForwardHistory:b,selectAnnotationFromHover:m,selectVertexFromHover:v,setSelectedTool:f,moveVertex:k,resetCanvasState:M,resetSelectedAnnotation:P,resetSelectedVertex:I,saveAnnotationsHistory:A,setCanvasSize:V,setSelectedClassID:w,loadAnnotations:H,resetHistory:j,setSelectedAnnotation:S,removeAnnotation:D,updateAnnotation:C,setIsDrawing:E,setIsEditing:K,drawPoint:N,moveSelectedPoint:T,setPreviousMousePosition:_,resetPreviousMousePosition:z,zoomIn:W,zoomOut:L,setOffsets:O,startDrawObb:B,updateDrawObb:R,updateHoveringHandle:F,setHandle:J,startDrawPoly:Q,updateDrawPoly:U,updateDrawPolyVertex:Z,resetHoveringVertex:G,setDrawingKeypointIndex:Y,startDrawPoseBbox:$,startDrawPosePoint:q,updateDrawPoseBbox:X,updateDrawPoseKeypoint:tt,updateHoveringPoseKeypoint:te,resetSelectedKeypoint:ta,selectKeypointFromHover:to}=d.actions,tn=d.reducer},2335:(t,e,a)=>{a.d(e,{A:()=>n});class o{static move(t,e,a){let o=!0;if(this.getVertices(t).forEach(t=>{var n,s;n=t.x,s=t.y,(!(n+e>=0)||!(n+e<=1)||!(s+a>=0)||!(s+a<=1))&&(o=!1)}),o){let o={...t};return o.xc=o.xc+e,o.yc=o.yc+a,o}return t}static moveVertex(t,e,a,o){let n=Math.min(1,Math.max(0,e)),s=Math.min(1,Math.max(0,a)),i=this.getVertices(t)[o],l=n-i.x,r=s-i.y,c=(e,a)=>{let{du:n,dv:s}=this.decomposeVector(e,a,t.alpha,t.imgW,t.imgH),i=this.vertexDirection(o),l=Math.abs(t.w+n*i.su),r=Math.abs(t.h+s*i.sv),c=t.xc+e/2,y=t.yc+a/2;return{...t,xc:c,yc:y,w:l,h:r}},y=c(l,r);if(this.getVertices(y).every(t=>t.x>=0&&t.x<=1&&t.y>=0&&t.y<=1))return y;let d=0,h=1;for(let t=0;t<15;t++){let t=(d+h)/2,e=c(l*t,r*t);this.getVertices(e).every(t=>t.x>=0&&t.x<=1&&t.y>=0&&t.y<=1)?d=t:h=t}return d<=1e-6?t:c(l*d,r*d)}static findNearestVertex(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02,n=this.getVertices(t),s=null,i=1/0;return n.forEach((t,n)=>{let l=Math.hypot(t.x-e,t.y-a);l<o&&l<i&&(i=l,s=n)}),s}static vertexDirection(t){switch(t){case 0:return{su:-1,sv:-1};case 1:return{su:1,sv:-1};case 2:return{su:1,sv:1};case 3:return{su:-1,sv:1};default:return{su:0,sv:0}}}static decomposeVector(t,e,a,o,n){let s=Math.cos(a),i=Math.sin(a);return{du:(t*o*s+e*n*i)/o,dv:(-(t*o*i)+e*n*s)/n}}static rotate(t,e){let a={...t,alpha:t.alpha+e};if(this.getVertices(a).every(t=>t.x>=0&&t.x<=1&&t.y>=0&&t.y<=1))return a;let o=0,n=1;for(let a=0;a<10;a++){let a=(o+n)/2,s={...t,alpha:t.alpha+e*a};this.getVertices(s).every(t=>t.x>=0&&t.x<=1&&t.y>=0&&t.y<=1)?o=a:n=a}return o<=1e-6?t:{...t,alpha:t.alpha+e*o}}static isHoveringHandle(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02,n=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,i=this.getHandle(t,n,s);return Math.hypot(i.x-e,i.y-a)<o}static draw(t,e){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[255,0,0],i=e.width,l=e.height,r=e.getContext("2d");if(null==r)return;r.strokeStyle="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 1)");let c=this.getVertices(t),y=c[0].x*i,d=c[0].y*l,h=c[1].x*i,x=c[1].y*l,p=c[2].x*i,g=c[2].y*l,u=c[3].x*i,b=c[3].y*l;if(r.lineWidth=1,r.fillStyle="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 0.9)"),r.beginPath(),r.rect(y-2,d-2,4,4),r.rect(h-2,x-2,4,4),r.rect(p-2,g-2,4,4),r.rect(u-2,b-2,4,4),r.fill(),null!=o){let e=this.getVertex(t,o);e&&r.rect(e.x*i-5,e.y*l-5,10,10),r.stroke()}r.closePath(),r.beginPath();let m=this.getHandle(t,i,l);r.arc(m.x*i,m.y*l,3,0,2*Math.PI),r.fill(),r.beginPath(),n&&(r.lineWidth=1,r.arc(m.x*i,m.y*l,6,0,2*Math.PI),r.stroke()),r.setLineDash([3,6]),r.moveTo(t.xc*i,t.yc*l),r.lineTo(m.x*i,m.y*l),r.stroke(),r.closePath(),r.beginPath(),r.setLineDash([]),r.moveTo(y,d),r.lineTo(h,x),r.lineTo(p,g),r.lineTo(u,b),r.closePath(),a&&(r.fillStyle="rgba(".concat(s[0],", ").concat(s[1],", ").concat(s[2],", 0.2)"),r.fill()),r.stroke()}static containPoint(t,e,a){let o=t.xc,n=t.yc,s=t.alpha,i=e-o,l=a-n,r=Math.cos(s),c=Math.sin(s);return Math.abs(i*r+l*c)<=t.w/2&&Math.abs(-i*c+l*r)<=t.h/2}static getHandle(t,e,a){let o=t.xc*e,n=t.yc*a,s=t.w*e,i=Math.cos(t.alpha),l=Math.sin(t.alpha),r=s/3;return{x:(o+r*i)/e,y:(n+r*l)/a}}static getVertex(t,e){let a,o;let n=t.xc*t.imgW,s=t.yc*t.imgH,i=t.w*t.imgW,l=t.h*t.imgH,r=Math.cos(t.alpha),c=Math.sin(t.alpha),y=.5*i,d=.5*l;switch(e){case 0:a=n-y*r+d*c,o=s-y*c-d*r;break;case 1:a=n+y*r+d*c,o=s+y*c-d*r;break;case 2:a=n+y*r-d*c,o=s+y*c+d*r;break;case 3:a=n-y*r-d*c,o=s-y*c+d*r}return{x:a/t.imgW,y:o/t.imgH}}static getVertices(t){return[0,1,2,3].map(e=>this.getVertex(t,e))}static longestDimSize(t){return Math.max(t.h,t.w)}}let n=o},2738:(t,e,a)=>{a.d(e,{M:()=>i});var o=a(1990),n=a(1783),s=a(1006);let i=(0,o.U1)({reducer:{canvas:n.Ay,settings:s.Ay}})},7132:(t,e,a)=>{a.d(e,{A:()=>n});class o{static move(t,e,a){if(!t.shell||0===t.shell.length)return t;let o=t.shell.map(t=>-t.x),n=t.shell.map(t=>1-t.x),s=t.shell.map(t=>-t.y),i=t.shell.map(t=>1-t.y),l=Math.max(...s),r=Math.min(...i),c=(t,e,a)=>e>a?0:Math.min(a,Math.max(e,t)),y=c(e,Math.max(...o),Math.min(...n)),d=c(a,l,r),h=t.shell.map(t=>({x:t.x+y,y:t.y+d}));return{...t,shell:h}}static draw(t,e){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[255,0,0],s=e.width,i=e.height,l=e.getContext("2d");if(null!=l){if(l.strokeStyle="rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", 1)"),l.fillStyle="rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", 1)"),l.lineWidth=1,l.beginPath(),t.shell.forEach(t=>{let e=t.x*s,a=t.y*i;l.rect(e-2,a-2,4,4)}),l.fill(),null!=o){let e=t.shell[o];e&&l.rect(e.x*s-5,e.y*i-5,10,10),l.stroke()}l.closePath(),l.beginPath(),t.shell.forEach((t,e)=>{let a=t.x*s,o=t.y*i;e?l.lineTo(a,o):l.moveTo(a,o)}),l.closePath(),a&&(l.fillStyle="rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", 0.2)"),l.fill()),l.stroke()}}static addVertex(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(-1==o)return{...t,shell:[...t.shell,{x:e,y:a}]};let n=[...t.shell.slice(0,o),{x:e,y:a},...t.shell.slice(o)];return{...t,shell:n}}static moveVertex(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,n=t=>Math.min(1,Math.max(0,t)),s=n(e),i=n(a),l=[...t.shell];return -1==o&&(o=l.length-1),l[o]&&(l[o]={x:s,y:i}),{...t,shell:l}}static findNearestVertex(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02,n=null,s=1/0;return t.shell.forEach((t,i)=>{let l=Math.hypot(t.x-e,t.y-a);l<o&&l<s&&(s=l,n=i)}),n}static isNearVertex(t,e,a,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.02,s=t.shell[o];return void 0!=s&&Math.hypot(s.x-e,s.y-a)<n}static containPoint(t,e,a){let o=t.shell,n=o.length,s=!1;for(let t=0;t<n;t++){let{x:i,y:l}=o[t],{x:r,y:c}=o[(t+1)%n];if(l>a!=c>a){if(i>e&&r>e)s=!s;else{if(i<e&&r<e)continue;let t=(r-i)*(a-l)/(c-l+1e-12)+i;if(1e-12>Math.abs(e-t))return!0;e<t&&(s=!s)}}}return s}static boundingBox(t){let e=Infinity,a=Infinity,o=-1/0,n=-1/0;return t.shell.forEach(t=>{t.x>o&&(o=t.x),t.x<e&&(e=t.x),t.y>n&&(n=t.y),t.y<a&&(a=t.y)}),{minX:e,minY:a,maxX:o,maxY:n}}static longestDimSize(t){let{minX:e,maxX:a,minY:o,maxY:n}=this.boundingBox(t);return Math.max(a-e,n-o)}}let n=o},7355:(t,e,a)=>{a.d(e,{A:()=>n});class o{static move(t,e,a){let o={...t},n=Math.max(-t.x1,-t.x2),s=Math.min(Math.min(1-t.x1,1-t.x2),Math.max(n,e)),i=Math.max(-t.y1,-t.y2),l=Math.min(Math.min(1-t.y1,1-t.y2),Math.max(i,a));return o.x1=t.x1+s,o.x2=t.x2+s,o.y1=t.y1+l,o.y2=t.y2+l,o}static moveVertex(t,e,a,o){if(null==o)return;let n=t=>Math.min(1,Math.max(0,t)),s=n(e),i=n(a),l={...t};switch(o){case 1:l.x1=s,l.y1=i;break;case 2:l.x2=s,l.y1=i;break;case 3:l.x2=s,l.y2=i;break;case 4:l.x1=s,l.y2=i}return l}static findNearestVertex(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02,n=new Map([[1,{x:t.x1,y:t.y1}],[2,{x:t.x2,y:t.y1}],[3,{x:t.x2,y:t.y2}],[4,{x:t.x1,y:t.y2}]]),s=null,i=1/0;return n.forEach((t,n)=>{let l=Math.hypot(t.x-e,t.y-a);l<o&&l<i&&(i=l,s=n)}),s}static draw(t,e){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[255,0,0],s=e.width,i=e.height,l=e.getContext("2d");if(null==l)return;l.strokeStyle="rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", 1)");let r=t.x1*s,c=t.x2*s,y=t.y1*i,d=t.y2*i;if(l.beginPath(),l.lineWidth=1,l.fillStyle="rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", 0.9)"),l.rect(r-2,y-2,4,4),l.rect(r-2,d-2,4,4),l.rect(c-2,y-2,4,4),l.rect(c-2,d-2,4,4),l.fill(),o){let e=this.giveVertex(t,o);e&&l.rect(e.x*s-5,e.y*i-5,10,10),l.stroke()}l.closePath(),l.beginPath(),l.rect(r,y,c-r,d-y),a&&(l.fillStyle="rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", 0.2)"),l.fill()),l.stroke(),l.closePath()}static containPoint(t,e,a){let o=Math.min(t.x1,t.x2),n=Math.max(t.x1,t.x2),s=Math.min(t.y1,t.y2),i=Math.max(t.y1,t.y2);return!!(o<e)&&!!(e<n)&&!!(s<a)&&!!(a<i)}static giveVertex(t,e){switch(e){case 1:return{x:t.x1,y:t.y1};case 2:return{x:t.x2,y:t.y1};case 3:return{x:t.x2,y:t.y2};case 4:return{x:t.x1,y:t.y2};default:return null}}static longestDimSize(t){return Math.max(Math.abs(t.y2-t.y1),Math.abs(t.x2-t.x1))}}let n=o},8108:(t,e,a)=>{a.d(e,{A:()=>n});class o{static move(t,e,a){let o=e>=0&&e<=1?e:t.x,n=a>=0&&a<=1?a:t.y;return{...t,x:o,y:n}}static isNear(t,e,a){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02;return Math.hypot(t.x-e,t.y-a)<o}static draw(t,e){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[255,0,0],n=e.width,s=e.height,i=t.x*n,l=t.y*s,r=e.getContext("2d");r&&(r.beginPath(),r.fillStyle="rgba(".concat(o[0],", ").concat(o[1],", ").concat(o[2],", 0.9)"),r.arc(i,l,3,0,2*Math.PI),r.fill(),r.closePath(),a&&(r.beginPath(),r.strokeStyle="rgba(".concat(o[0],", ").concat(o[1],", ").concat(o[2],", 0.8)"),r.lineWidth=2,r.arc(i,l,6,0,2*Math.PI),r.stroke(),r.closePath()))}}let n=o}}]);